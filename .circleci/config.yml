jobs:
  sonarcloud:
    docker:
      - image: 'node:latest'
    steps:
      - checkout
      - sonarcloud/scan
  test2:
    docker:
      - image: 'node:latest'
    steps:
      - checkout
      - run: npm install
      - snyk/scan
  build:
    docker:
      - image: 'node:latest'
    steps:
      - checkout
      - run: 
          name: build
          command: | 
            npm install
            npm start&
  test:
    docker:
      - image: 'node:latest'
    steps:
      - checkout
      - run: 
          name: test
          command: | 
            npm install
            npm install -g typescript
            cd test
            tsc apiTestsSetup.ts
            wget http://localhost:3000
   
orbs:
  sonarcloud: sonarsource/sonarcloud@1.0.3
  snyk: snyk/snyk@1.1.2
version: 2.1
workflows:
  main:
    jobs:
      # - sonarcloud:
        #  context: SonarCloud
      #- test2
      # - build:
         # requires: 
           # - sonarcloud
      - test:
          # requires: 
            # - build
